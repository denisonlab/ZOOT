---
title: "tazoot_swapAcc"
author: Jenny
output: github_document
date: "2024-10-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
suppressPackageStartupMessages(library(tidyverse))
library(ez)
library(foreach)
library(kableExtra)
library(ggplot2)
library(dplyr)
library(ggpubr)
library(lsr)
library(report)
library(rempsyc) # for t-tests in nice tables
knitr::opts_chunk$set(echo = TRUE)

#### anova setup #### 
options(contrasts=c("contr.sum","contr.poly"))

#### load data #### 
wd <- getwd()
analysisName = 'tazoot_swapAcc'
dataName <- sprintf("/Users/jennymotzer/Documents/GitHub/ZOOT/stats/%s.csv", analysisName)
data <- read.csv(dataName)

#### Change to categorical vars ####
data$SID <- factor(data$SID)
data$targetContrast <- factor(data$targetContrast)
data$nontargetContrast <- factor(data$nontargetContrast)
data$Target <- factor(data$Target)
data$Validity <- factor(data$Validity)

### Plotting setup #### 
colors = c("#F8A299","#CCCCCC","#98E6A1")
attComparison <- list( c("1","3"), c("1","2"), c("2","3") )

significance <- list(cutpoints = c(0, 0.0001, 0.001, 0.01, 0.05, Inf),
symbols = c("****", "***", "**", "*", "ns"))
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r swap accuracy}
# swap accuracy 
d <- data 
acc_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(targetContrast, nontargetContrast, Target, Validity)
)

print(acc_anova)
```


```{r swap accuracy target present}
# swap accuracy target present 
d <- data %>% filter(targetContrast==1)
accTP_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(nontargetContrast, Target, Validity)
)

print(accTP_anova)
```

```{r swap accuracy target absent}
# swap accuracy target absent 
d <- data %>% filter(targetContrast==0)
accTA_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(nontargetContrast, Target, Validity)
)

print(accTA_anova)
```

```{r swap accuracy target present nontarget present}
# swap accuracy target present nontarget present
d <- data %>% filter(targetContrast==1, nontargetContrast==1)
accTPNP_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Target, Validity)
)

print(accTPNP_anova)
```

```{r swap accuracy target present nontarget absent}
# swap accuracy target present nontarget absent
d <- data %>% filter(targetContrast==1, nontargetContrast==0)
accTPNA_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Target, Validity)
)

print(accTPNA_anova)
```

```{r swap accuracy target absent nontarget present}
# swap accuracy target absent nontarget present
d <- data %>% filter(targetContrast==0, nontargetContrast==1)
accTANP_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Target, Validity)
)

print(accTANP_anova)
```

```{r swap accuracy target absent nontarget absent}
# swap accuracy target absent nontarget absent
d <- data %>% filter(targetContrast==0, nontargetContrast==0)
accTANA_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Target, Validity)
)

print(accTANA_anova)
```

```{r swap accuracy target present nontarget present T1}
# swap accuracy target present nontarget present T1
d <- data %>% filter(targetContrast==1, nontargetContrast==1, Target == 1)
accTPNP_T1_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTPNP_T1_anova)
```

```{r swap accuracy target present nontarget absent T1}
# swap accuracy target present nontarget absent T1
d <- data %>% filter(targetContrast==1, nontargetContrast==0, Target == 1)
accTPNA_T1_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTPNA_T1_anova)
```

```{r swap accuracy target absent nontarget present T1}
# swap accuracy target absent nontarget present T1
d <- data %>% filter(targetContrast==0, nontargetContrast==1, Target==1)
accTANP_T1_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTANP_T1_anova)
```

```{r swap accuracy target absent nontarget absent T1}
# swap accuracy target absent nontarget absent T1
d <- data %>% filter(targetContrast==0, nontargetContrast==0, Target==1)
accTANA_T1_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTANA_T1_anova)
```

```{r swap accuracy target present nontarget present T2}
# swap accuracy target present nontarget present T2
d <- data %>% filter(targetContrast==1, nontargetContrast==1, Target == 2)
accTPNP_T2_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTPNP_T2_anova)
```

```{r swap accuracy target present nontarget absent T2}
# swap accuracy target present nontarget absent T2
d <- data %>% filter(targetContrast==1, nontargetContrast==0, Target == 2)
accTPNA_T2_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTPNA_T2_anova)
```

```{r swap accuracy target absent nontarget present T2}
# swap accuracy target absent nontarget present T2
d <- data %>% filter(targetContrast==0, nontargetContrast==1, Target==2)
accTANP_T2_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTANP_T2_anova)
```

```{r swap accuracy target absent nontarget absent T2}
# swap accuracy target absent nontarget absent T2
d <- data %>% filter(targetContrast==0, nontargetContrast==0, Target==2)
accTANA_T2_anova = ezANOVA(
  data = d,
  dv = .(swapAcc),
  wid = .(SID),
  within = .(Validity)
)

print(accTANA_T2_anova)
```

### t-tests
## target/nontarget presence 
# T1
```{r vi_accPPT1, echo = FALSE, out.width = "90%"}
## valid vs. invalid PP T1
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 1, Target == 1, Validity == 1 | Validity == 3)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PP T1 valid vs invalid")
my_table
```

```{r vn_accPPT1, echo = FALSE, out.width = "90%"}
## valid vs. neutral PP T1
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 1, Target == 1, Validity == 1 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PP T1 valid vs neutral")
my_table
```

```{r in_accPPT1, echo = FALSE, out.width = "90%"}
## invalid vs. neutral PP T1
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 1, Target == 1, Validity == 3 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PP T1 invalid vs neutral")
my_table
```

```{r vi_accAPT1, echo = FALSE, out.width = "90%"}
## valid vs. invalid AP T1
d <- data 
dt <- d %>% filter(targetContrast == 0, nontargetContrast == 1, Target == 1, Validity == 1 | Validity == 3)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: AP T1 valid vs invalid")
my_table
```

```{r vn_accAPT1, echo = FALSE, out.width = "90%"}
## valid vs. neutral AP T1
d <- data 
dt <- d %>% filter(targetContrast == 0, nontargetContrast == 1, Target == 1, Validity == 1 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: AP T1 valid vs neutral")
my_table
```

```{r in_accAPT1, echo = FALSE, out.width = "90%"}
## invalid vs. neutral AP T1
d <- data 
dt <- d %>% filter(targetContrast == 0, nontargetContrast == 1, Target == 1, Validity == 3 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: AP T1 invalid vs neutral")
my_table
```


```{r vi_accPAT1, echo = FALSE, out.width = "90%"}
## valid vs. invalid PA T1
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 0, Target == 1, Validity == 1 | Validity == 3)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PA T1 valid vs invalid")
my_table
```

```{r vn_accPAT1, echo = FALSE, out.width = "90%"}
## valid vs. neutral PA T1
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 0, Target == 1, Validity == 1 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PA T1 valid vs neutral")
my_table
```

```{r in_accPAT1, echo = FALSE, out.width = "90%"}
## invalid vs. neutral PA T1
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 0, Target == 1, Validity == 3 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PA T1 invalid vs neutral")
my_table
```

#T2

```{r vi_accPPT2, echo = FALSE, out.width = "90%"}
## valid vs. invalid PP T2
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 1, Target == 2, Validity == 1 | Validity == 3)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PP T2 valid vs invalid")
my_table
```

```{r vn_accPPT2, echo = FALSE, out.width = "90%"}
## valid vs. neutral PP T2
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 1, Target == 2, Validity == 1 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PP T2 valid vs neutral")
my_table
```

```{r in_accPPT2, echo = FALSE, out.width = "90%"}
## invalid vs. neutral PP T2
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 1, Target == 2, Validity == 3 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PP T2 invalid vs neutral")
my_table
```

```{r vi_accAPT2, echo = FALSE, out.width = "90%"}
## valid vs. invalid AP T2
d <- data 
dt <- d %>% filter(targetContrast == 0, nontargetContrast == 1, Target == 2, Validity == 1 | Validity == 3)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: AP T2 valid vs invalid")
my_table
```

```{r vn_accAPT2, echo = FALSE, out.width = "90%"}
## valid vs. neutral AP T2
d <- data 
dt <- d %>% filter(targetContrast == 0, nontargetContrast == 1, Target == 2, Validity == 1 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: AP T2 valid vs neutral")
my_table
```

```{r in_accAPT2, echo = FALSE, out.width = "90%"}
## invalid vs. neutral AP T2
d <- data 
dt <- d %>% filter(targetContrast == 0, nontargetContrast == 1, Target == 2, Validity == 3 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: AP T2 invalid vs neutral")
my_table
```


```{r vi_accPAT2, echo = FALSE, out.width = "90%"}
## valid vs. invalid PA T2
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 0, Target == 2, Validity == 1 | Validity == 3)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PA T2 valid vs invalid")
my_table
```

```{r vn_accPAT2, echo = FALSE, out.width = "90%"}
## valid vs. neutral PA T2
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 0, Target == 2, Validity == 1 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PA T2 valid vs neutral")
my_table
```

```{r in_accPAT2, echo = FALSE, out.width = "90%"}
## invalid vs. neutral PA T2
d <- data 
dt <- d %>% filter(targetContrast == 1, nontargetContrast == 0, Target == 2, Validity == 3 | Validity == 2)
t.test(dt$swapAcc ~ dt$Validity, paired=TRUE) %>% report %>%
  as.data.frame -> stats.table
names(stats.table) <- c(
  "Parameter", "Group", "Difference", "t", "df", "p", "CI", "CI_lower", "CI_upper",
  "Method", "Alternative", "Cohens_d", "d_CI_low", "d_CI_high"
)
my_table <- nice_table(stats.table, report = "t.test", title = "tazoot swap acc: PA T2 invalid vs neutral")
my_table
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
